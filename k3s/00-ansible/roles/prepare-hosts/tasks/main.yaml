---
- name: Install packages
  dnf:
    name:
      - net-tools
      - mc
      - vim
      - git
      - bash-completion
      - nfs-utils
      - python3
      - tar
      - rsyslog
      - python3-libselinux
    state: latest

- name: Enable rsyslog
  service:
    name: rsyslog
    state: started
    enabled: yes

- name: Check Disable SELinux
  selinux:
    state: disabled
  register: selinux_ret

- name: Disable SELinux
  shell: setenforce 0
  when: selinux_ret.reboot_required

- name: Add firewalld rules
  firewalld:
    port: 6443/tcp
    permanent: yes
    state: enabled
- firewalld:
    port: 51820/tcp
    permanent: yes
    state: enabled
- firewalld:
    port: 51821/tcp
    permanent: yes
    state: enabled
- firewalld:
    port: 10250/tcp
    permanent: yes
    state: enabled
- firewalld:
    port: 2379-2380/tcp
    permanent: yes
    state: enabled
- firewalld:
    port: 8472/udp
    permanent: yes
    state: enabled
