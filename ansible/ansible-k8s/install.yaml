---
- name: Install docker and k8s packages
  hosts: k8s_cluster
  become: yes
  roles:
    # Containerd CRI
    - containerd_install
    # Докер CRI
    # - docker_install
    - k8s_packages_install

- name: Install HA for k8s API access and vrrl on control plane servers
  hosts: k8s_controls
  become: yes
  roles:
    - ha_install

- name: Install k8s control plane and calico network on the 1st node
  hosts: k8s_1st_master
  become: yes
  roles:
    # Докер CRI
    #- k8s_master_setup
    # Containerd CRI
    - k8s_master_containerd_setup
    - k8s_calico_setup

- name: Install k8s control plane in the other nodes
  hosts: k8s_other_masters
  become: yes
  roles:
    - k8s_anoter_master_setup

- name: Add k8s worker nodes
  hosts: k8s_workers
  become: yes
  roles:
    - k8s_workers_setup
